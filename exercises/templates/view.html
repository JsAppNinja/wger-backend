{% extends "base.html" %}
{% load i18n %} 
{% load staticfiles %}


{% block header %}
<script src="{% static "js/jquery-ui.js" %}"></script>
<script src="{% static "js/tinymce/tiny_mce.js" %}"></script>
<script src="{% static "js/workout-manager.js" %}"></script>

<script>
$(document).ready(function() {
// Initialise a modal dialog
    $("#ajax-info").dialog({
                autoOpen: false,
                width: 600,
                modal: true,
    });


    // Load the edit dialog when a user wants to edit an exercise
    $(".modal-dialog").click(function(e) {
        e.preventDefault();
        targetUrl = $(this).attr("href");

		$("#ajax-info").load(targetUrl + " .ym-form", function() {
  		
  		// Initialise the WYSIWYG editor
        init_tinymce();
        }
  	);
        $("#ajax-info").dialog("open");
        
        
    });
});

</script>
{% endblock %}
<!--
        Title
-->
{% block title %}{{ exercise.name }}{% endblock %}


<!--
        Main Content
-->
{% block content %}

<h2>{{ exercise.name }}</h2>

<p>{% trans "Category" %}: <strong>{{ exercise.category.name }}</strong></p>

<p>{{ exercise.description|safe }}</p>

<table>
    <thead>
        <tr>
            <th colspan="2">{% trans "All comments for this exercise" %}</th>
        </tr>
    </thead>
    <tbody>
{% for comment in exercise.exercisecomment_set.all %}
    <tr>
        <td>
            {% if comment_edit.id == comment.id %}
            <form action="{% url exercises.views.exercise_view exercise.id comment.id %}" method="post">
                {% csrf_token %}
                {{ comment_edit_form.comment }}
                <input type="submit" value="{% trans "Save" %}" />
            </form>
            {% else %}
            {{ comment }}
            {% endif %}
        </td>
        <td class="align-right">
        {% if perms.exercises %}
            <div class="editoptions">
                <a href="{% url exercises.views.exercisecomment_delete comment.id %}" title="{% trans "Delete" %}">[x]</a>
                <a href="{% url exercises.views.exercise_view exercise.id comment.id %}" title="{% trans "Edit" %}">[e]</a>
            </div>
         {% endif %}
        </td>
    </tr>
{% empty %}
    <tr>
        <td>{% trans "Sorry, no comments for this exercise yet!" %}</td>
    </tr>
{% endfor %}
</ul>
    </tbody>
</table>

<h3>{% trans "Add new comment" %}</h3>
<form action = "{% url exercises.views.exercise_view exercise.id %}"
      method = "post"
      id = "new_comment_form">
{% csrf_token %}
{{ comment_form.comment }}
<input type="submit" value="{% trans "Save" %}" />
</form>


<div class="apple_overlay" id="overlay" title="Basic dialog">
  <!-- the external content is loaded inside this tag -->
  <div class="contentWrap"></div>
</div>

<div id="exposeMask"></div>

{% endblock %}


<!--
        Side bar?
-->
{% block sidebar %}
{% if perms.exercises %}
    <h3>{% trans "Options" %}</h3>
    <p>
        <a href="{% url exercises.views.exercise_edit exercise.id %}"
           class="modal-dialog">
            <img src="{% static 'images/icons/edit.svg' %}"
                 width="32"
                 height="32"
                 alt="{% trans 'Edit' %}"
                 >
            {% trans "Edit" %}
        </a>
    </p>
    <p>
        <a href="{% url exercises.views.exercise_delete exercise.id %}">
    	<img src="{% static 'images/icons/trash.svg' %}"
             width="32"
             height="32"
             alt="{% trans 'Delete' %}">
    	    {% trans "Delete" %}
	    </a>
    </p>
{% endif %}
{% endblock %}
