<!DOCTYPE html>
{% load i18n %}
{% load staticfiles %}
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta charset="utf-8">
    <meta name="author" content="Roland Geider">

    <!--
    This file is part of Workout Manager

    Workout Manager is free software: you can redistribute it and/or modify
    it under the terms of the GNU Affero General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    Workout Manager is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU Affero General Public License for more details.

    You should have received a copy of the GNU Affero General Public License
    along with Workout Manager. If not, see <http://www.gnu.org/licenses/>.
    -->

    <link rel="stylesheet" type="text/css" href="{% static 'css/yaml/demos/css/flexible-grids.css' %} "> <!-- CSS framework for the layout -->
    <link rel="stylesheet" type="text/css" href="{% static 'css/yaml/custom-yaml.css' %}">               <!-- Customisations for yaml      -->
    <link rel="stylesheet" type="text/css" href="{% static 'css/workout-manager.css' %}">                <!-- Own CSS classes and styles      -->
    <link rel="stylesheet" type="text/css" href="{% static 'css/jquery-ui.css' %}">                      <!-- CSS for Jqyery UI elements   -->


    <script src="https://browserid.org/include.js" type="text/javascript"></script>
    <script src="{% static 'js/jquery.js' %}"></script>
    <script src="{% static 'js/jquery-ui.js' %}"></script>
    <script src="{% static 'js/workout-manager.js' %}"></script>
    {% block header %}{% endblock %}
 
    <script>
    navigator.id.watch({
      loggedInUser: {% if user.is_authenticated %}"{{user.email}}"{% else %}null{% endif %},
      onlogin: function(assertion) {
                
        var $e = $('#id_assertion');
        $e.val(assertion.toString());
        
        $.ajax({
          type: 'POST',
          url: $('#browserid-form').attr('action'),
          data: $('#browserid-form').serialize(),
          success: function(res, status, xhr) { window.location = '/'; },
          error: function(xhr, status, err) { alert("login failure: " + err); }
        });
      },
      onlogout: function() {
        $.ajax({
          type: 'POST',
          url: '/logout',
          success: function(res, status, xhr) { window.location.reload(); },
          error: function(xhr, status, err) { alert("logout failure: " + err); }
        });
      }
    });
    
    
    $(document).ready(function() {
          
        $('#browserid-login').bind('click', function(e) {
                navigator.id.request({siteName: 'Workout Manager'});
            });
        
        $('#logout').bind('click', function(e) {
                navigator.id.logout();
            });
        
        // Init the modal dialog for editing forms
        form_modal_dialog();
     });
    </script>

    <title>{% block title %}{% endblock %}</title>
</head>
<body>
<header>
    <div class="ym-wrapper">
        <div class="ym-wbox">
            <h1>Workout manager</h1>
        </div>
    </div>
</header>
<nav id="nav">
    <div class="ym-wrapper">
        <div class="ym-hlist">
            <ul>
                <li {% if active_tab == 'user' %}class="active"{% endif %}>
            {% if not user.username %}
                <a href="{% url manager.views.login %}">{% trans "Login" %}</a>
            {% else %}
                <a href="{% url manager.views.index %}">{% trans "Dashboard" %}</a>
            {% endif %}
                </li>
                <li {% if active_tab == 'workout'   %}class="active"{% endif %}><a href="{% url manager.views.overview %}">{% trans "Workouts" %}</a></li>
                <li {% if active_tab == 'exercises' %}class="active"{% endif %}><a href="{% url exercises.views.exercise_overview %}">{% trans "Exercises" %}</a></li>
                <li {% if active_tab == 'weight'    %}class="active"{% endif %}><a href="{% url weight.views.overview %}">{% trans "Weight" %} </a></li>
                <li {% if active_tab == 'nutrition' %}class="active"{% endif %}><a href="{% url nutrition.views.overview %}">{% trans "Nutrition" %} </a></li>
            </ul>
            
            
            {% if user.username %}
            <ul style="float:right;">
            <li>
                <a href="{% url manager.views.logout %}" id="logout">
                {% trans 'Logout' %}
                </a>
            </li>
            </ul>
            {% endif %}
        </div>
    </div>
</nav>

<div id="main">
    <div class="ym-wrapper">
        <section >
            <div class="ym-grid linearize-level-1">
                <article class="ym-g80 ym-gl">
                    <div class="ym-gbox-left box invisible" id="ajax-info">
                        
                    </div>
                </article>
            </div>
        </section>
        <div class="ym-wbox">
            <section class="ym-grid linearize-level-1">
                <article class="ym-g66 ym-gl content">
                    <div class="ym-gbox-left ym-clearfix" id="main-content">
                        {% block content %}{% endblock %}
                    </div>
                </article>
                <aside class="ym-g33 ym-gr" id="main-sidebar">
                    <div class="ym-gbox-right ym-clearfix">
                        {% block sidebar %}
                        {% endblock %}
                    </div>
                </aside>
            </section>
        </div>
    </div>
</div>



<footer>
    <div class="ym-wrapper">
    <div class="ym-wbox">
        <div class="ym-grid linearize-level-1">
            <div class="ym-g10 ym-gl">
                <a href="https://bitbucket.org/rolandgeider/workout_manager" class="no-hover">
                    <img src="{% static 'images/agplv3-88x31.png' %}"
                         alt="{% trans 'Released under the Affero GPL' %}"
                         title="{% trans 'Released under the Affero GPL' %}">
                </a>
            </div>
            <div class="ym-g40 ym-gl">
                <div class="ym-gbox-left">
                © <a href="mailto:roland@NO!SPAM!geider.net">Roland Geider</a>
                – {% trans "Layout based on <a href='http://www.yaml.de'>YAML</a>" %}
                </div>
            </div>
            <div class="ym-g50 ym-gr align-right">
                <div class="ym-gbox-right">
                    <em class="dimmed">{{version}}</em>
                </div>
            </div>
        </div>
    </div>
    </div>
</footer>
</body>
</html>
